from scapy.all import *
from scapy.layers.l2 import Ether, ARP

interface = "tun0"
ip_range = "10.10.248.38/24"
broadcastMac = "ff:ff:ff:ff:ff:ff"

packet = Ether(dis=broadcastMac)/ARP(pdst=ip_range)

ans, un_ans = srp(packet, timeout=2, iface=interface, inter=0.1)

for send, receive in ans:
    print(receive.sprintf(r"%Ether.src% - %ARP.src%"))
